{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/tharunkumarl/Full%20Stack/maa-ilay/backend/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\nimport { PrismaNeon } from '@prisma/adapter-neon'\nimport { neonConfig } from '@neondatabase/serverless'\n\n// Configure WebSocket for non-edge environments\nif (typeof globalThis.WebSocket === 'undefined') {\n  // eslint-disable-next-line @typescript-eslint/no-require-imports\n  neonConfig.webSocketConstructor = require('ws')\n}\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nfunction createPrismaClient() {\n  const connectionString = process.env.DATABASE_URL!\n  const adapter = new PrismaNeon({ connectionString })\n  \n  return new PrismaClient({\n    adapter,\n    log: process.env.NODE_ENV === 'development' ? ['error', 'warn'] : ['error'],\n  })\n}\n\nexport const prisma = globalForPrisma.prisma ?? createPrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n\nexport default prisma\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,gDAAgD;AAChD,IAAI,OAAO,WAAW,SAAS,KAAK,aAAa;IAC/C,iEAAiE;IACjE,sKAAU,CAAC,oBAAoB;AACjC;AAEA,MAAM,kBAAkB;AAIxB,SAAS;IACP,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;IACjD,MAAM,UAAU,IAAI,6KAAU,CAAC;QAAE;IAAiB;IAElD,OAAO,IAAI,sMAAY,CAAC;QACtB;QACA,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;IACpE;AACF;AAEO,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///Users/tharunkumarl/Full%20Stack/maa-ilay/backend/src/lib/auth-customer.ts"],"sourcesContent":["import { NextAuthOptions } from \"next-auth\"\nimport GoogleProvider from \"next-auth/providers/google\"\nimport prisma from \"./prisma\"\n\nexport type UserRole = \"customer\"\n\ndeclare module \"next-auth\" {\n  interface User {\n    id: string\n    role: UserRole\n    phone?: string\n    status?: string\n  }\n\n  interface Session {\n    user: {\n      id: string\n      name?: string | null\n      email?: string | null\n      image?: string | null\n      role: UserRole\n      phone?: string\n      status?: string\n    }\n  }\n}\n\ndeclare module \"next-auth/jwt\" {\n  interface JWT {\n    id: string\n    role: UserRole\n    phone?: string\n    status?: string\n  }\n}\n\n/**\n * NextAuth configuration for CUSTOMERS ONLY\n * Only includes Google OAuth provider - no signin UI needed\n */\nexport const authOptionsCustomer: NextAuthOptions = {\n  providers: [\n    // Google OAuth for Customers\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID!,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,\n      authorization: {\n        params: {\n          prompt: \"select_account\",\n          access_type: \"offline\",\n          response_type: \"code\"\n        }\n      },\n      allowDangerousEmailAccountLinking: true,\n    }),\n  ],\n\n  callbacks: {\n    async signIn({ user, account }) {\n      if (account?.provider === \"google\") {\n        try {\n          const existingCustomer = await prisma.customer.findUnique({\n            where: { email: user.email! }\n          })\n\n          if (existingCustomer) {\n            user.role = \"customer\"\n            user.id = existingCustomer.id\n            user.status = existingCustomer.status\n          } else {\n            user.role = \"customer\"\n            user.status = \"NEW\"\n          }\n          return true\n        } catch (error) {\n          console.error(\"SignIn error:\", error)\n          return true\n        }\n      }\n      return true\n    },\n\n    async jwt({ token, user, account, trigger }) {\n      if (user) {\n        token.id = user.id\n        token.role = user.role\n        token.phone = user.phone\n        token.status = user.status\n      }\n\n      if (account?.provider === \"google\" && token.email) {\n        const customer = await prisma.customer.findUnique({\n          where: { email: token.email }\n        })\n\n        if (customer) {\n          token.id = customer.id\n          token.role = \"customer\"\n          token.status = customer.status\n          token.phone = customer.phone\n        } else {\n          token.role = \"customer\"\n          token.status = \"NEW\"\n        }\n      }\n\n      if (trigger === \"update\" && token.role === \"customer\" && token.id) {\n        const customer = await prisma.customer.findUnique({\n          where: { id: token.id }\n        })\n        if (customer) {\n          token.status = customer.status\n        }\n      }\n\n      return token\n    },\n\n    async session({ session, token }) {\n      if (session.user) {\n        session.user.id = token.id\n        session.user.role = token.role\n        session.user.phone = token.phone\n        session.user.status = token.status\n      }\n      return session\n    },\n\n    async redirect({ url, baseUrl }) {\n      const frontendUrl = process.env.NEXT_PUBLIC_FRONTEND_URL || \"http://localhost:5173\"\n\n      if (url.startsWith(frontendUrl)) {\n        return url\n      }\n\n      if (url.startsWith(\"/\")) {\n        return `${frontendUrl}${url}`\n      }\n\n      if (url.startsWith(baseUrl)) {\n        return url.replace(baseUrl, frontendUrl)\n      }\n\n      return `${frontendUrl}/customer/dashboard`\n    }\n  },\n\n  session: {\n    strategy: \"jwt\",\n    maxAge: 30 * 24 * 60 * 60, // 30 days\n  },\n\n  secret: process.env.NEXTAUTH_SECRET,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":["file:///Users/tharunkumarl/Full%20Stack/maa-ilay/backend/src/app/api/auth-customer/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport { authOptionsCustomer } from \"@/lib/auth-customer\"\n\n/**\n * Customer-only authentication endpoint\n * Only includes Google OAuth - no signin UI needed\n * Direct redirect to Google when accessed\n */\nconst handler = NextAuth(authOptionsCustomer)\n\nexport { handler as GET, handler as POST }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA;;;;CAIC,GACD,MAAM,UAAU,IAAA,kJAAQ,EAAC,uJAAmB"}}]
}